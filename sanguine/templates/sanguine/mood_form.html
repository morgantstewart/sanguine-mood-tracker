{% extends 'base.html' %} 
{% load static %} 
{% block head %}
<link rel="stylesheet" href="{% static 'css/form.css' %}" />
{% endblock %} 
{% block content %}

<div class="page-header">
    <div class="page-header">
        {% if mood %}
          <h1>Edit {{ mood.name }}</h1>
        {% else %}
        {% endif %}
      </div>

  <h1>Add a Mood</h1>
  <img src="{% static 'images/' %}" alt="A mood" />
</div>

<form action="" method="post" class="form-container">
  {% csrf_token %}
  
  <!-- Mood Selection -->
  <div class="mood-selection">
    <h3>How are you feeling?</h3>
    <div class="mood-grid">
      <div class="mood-option mood-depressed" data-mood="depressed">
        <span>Depressed</span>
        <input type="radio" name="mood_type" value="depressed" id="mood_depressed" style="display: none;" {% if form.mood_type.value == 'depressed' %}checked{% endif %}>
      </div>
      <div class="mood-option mood-sad" data-mood="sad">
        <span>Sad</span>
        <input type="radio" name="mood_type" value="sad" id="mood_sad" style="display: none;" {% if form.mood_type.value == 'sad' %}checked{% endif %}>
      </div>
      <div class="mood-option mood-okay" data-mood="okay">
        <span>Okay</span>
        <input type="radio" name="mood_type" value="okay" id="mood_okay" style="display: none;" {% if form.mood_type.value == 'okay' %}checked{% endif %}>
      </div>
      <div class="mood-option mood-good" data-mood="good">
        <span>Good</span>
        <input type="radio" name="mood_type" value="good" id="mood_good" style="display: none;" {% if form.mood_type.value == 'good' %}checked{% endif %}>
      </div>
      <div class="mood-option mood-happy" data-mood="happy">
        <span>Happy</span>
        <input type="radio" name="mood_type" value="happy" id="mood_happy" style="display: none;" {% if form.mood_type.value == 'happy' %}checked{% endif %}>
      </div>
      <div class="mood-option mood-ecstatic" data-mood="ecstatic">
        <span>Ecstatic</span>
        <input type="radio" name="mood_type" value="ecstatic" id="mood_ecstatic" style="display: none;" {% if form.mood_type.value == 'ecstatic' %}checked{% endif %}>
      </div>
      <div class="mood-option mood-irritated" data-mood="irritated">
        <span>Irritated</span>
        <input type="radio" name="mood_type" value="irritated" id="mood_irritated" style="display: none;" {% if form.mood_type.value == 'irritated' %}checked{% endif %}>
      </div>
      <div class="mood-option mood-mad" data-mood="mad">
        <span>Mad</span>
        <input type="radio" name="mood_type" value="mad" id="mood_mad" style="display: none;" {% if form.mood_type.value == 'mad' %}checked{% endif %}>
      </div>
    </div>
  </div>

  <table>
    <tr>
      <th>{{ form.description.label_tag }}</th>
      <td>{{ form.description }}</td>
    </tr>
    <tr>
      <th>{{ form.date.label_tag }}</th>
      <td>
        <input type="date" name="{{ form.date.name }}" id="{{ form.date.id_for_label }}" 
               value="{% if form.date.value %}{{ form.date.value|date:'Y-m-d' }}{% else %}{{ form.date.field.initial|default:'' }}{% endif %}"
               class="date-picker">
      </td>
    </tr>
  </table>
  <button type="submit" class="btn submit">Submit!</button>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const moodOptions = document.querySelectorAll('.mood-option');
    
    moodOptions.forEach(option => {
        option.addEventListener('click', function() {
            // Remove selected class from all options
            moodOptions.forEach(opt => opt.classList.remove('selected'));
            
            // Add selected class to clicked option
            this.classList.add('selected');
            
            // Check the corresponding radio button
            const radioButton = this.querySelector('input[type="radio"]');
            radioButton.checked = true;
        });
    });
    
    // Set selection based on form data or default to happy
    const checkedRadio = document.querySelector('input[name="mood_type"]:checked');
    let selectedMood = 'happy'; // default
    
    if (checkedRadio) {
        selectedMood = checkedRadio.value;
    }
    
    const defaultOption = document.querySelector(`[data-mood="${selectedMood}"]`);
    if (defaultOption) {
        defaultOption.classList.add('selected');
        const defaultRadio = defaultOption.querySelector('input[type="radio"]');
        defaultRadio.checked = true;
    }
});
</script>

{% endblock %}
